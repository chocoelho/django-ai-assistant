{% extends "demo/htmx_index.html" %}

{% block body %}
  <div class="d-flex vh-100">
    <aside class="col-3 border-right p-3 bg-light">
      <div
        id="threads-wrapper"
      >
        {% block threads_list %}
          <div id="threads-container" hx-swap-oob="true">
            <h3>Threads</h3>

            <div id="threads-list" class="list-group flex-grow-1 overflow-auto">
              {% for thread in threads %}
                <a
                  class="thread-item list-group-item list-group-item-action {% if thread.id == thread_id %}active-thread{% endif %}"
                  href="{% url 'chat_thread' thread.id %}"
                  hx-get="{% url 'chat_thread' thread.id %}"
                  hx-target="#messages-wrapper"
                  hx-swap="outerHTML"
                  hx-select="#messages-wrapper"
                  hx-select-oob="#threads-container"
                  hx-push-url="true"
                >
                  {{ thread.name }}
                </a>
              {% endfor %}
            </div>

            <button
              id="create-thread-button"
              class="btn btn-primary mt-3"
              hx-post='{% url "chat_home" %}'
              hx-target="#threads-container"
              hx-swap="outerHTML"
              hx-select="#threads-container"
              hx-push-url="true"
              data-loading-disable
            >
              Create Thread
            </button>
          </div>
        {% endblock %}
      </div>
    </aside>

    <main class="col-9 d-flex flex-column p-3 main-container">
      <h2 class="mb-4">Chat</h2>

      <div class="text-center my-3" data-loading>
        <svg class="spinner" viewBox="0 0 50 50">
          <circle
            class="path"
            cx="25"
            cy="25"
            r="20"
            fill="none"
            stroke-width="5"
          ></circle>
        </svg>
      </div>

      <!-- This will be replaced by reponses from django_ai_assistant:messages_list_create-->
      <div id="messages-wrapper" class="h-100" hx-indicator="#indicator">
        {% block message_list %}
          <div class="text-center text-muted my-3">
            Select or create a thread to start chatting.
          </div>
        {% endblock %}
      </div>
    </main>
  </div>
{% endblock %}
